# Структура программы
## Классы:
### Класс WordDocx
- Экземпляр класса - docx файл досье
- Функция замены открывает файл как менеджер контекста и меняет текст на необходимый
- Возможно понадобится несколько подклассов для каждого модуля
###### Атрибуты: 
1. название документа
2. код раздела (получаем из названия)
3. код документа (получаем из названия)
4. название производителя (необязательный)
5. название АФС (необязательный)
###### Методы:
1. замена текста (словарь для замены формируется пользователем)
2. добавление "_____" к названию документа для редактируемых вручную файлов (список предзадан в программе)
3. изменение атрибутов-маркеров в названии (при наличии)
4. сохранение в новую подпапку

### Класс WordDoc
- дочерний от WordDocx
- имеет один доп. метод
###### Методы:
1. замена формата .doc на .docx

### Класс PdfTxtDoc
###### Атрибуты: 
1. название документа
###### Методы:
1. создание в целевой папке документа .txt с названием исходного pdf-файла

### Класс PdfDoc
###### Атрибуты: 
1. название документа
2. код раздела (получаем из названия)
3. код документа (получаем из названия)
###### Методы:
1. добавлен извне и просто существует
2. подгружается в XML (метод класса XML)
3. хешируется (md5-хеш), название файла меняется на №раздела_код_хеш (1.0_01001_Xk30KRO420glsbov0489Fbj42kgEhgC392)

### Класс ZipDoc
###### Атрибуты: 
1. Шаблон папки с 5 подпапками по модулям.
###### Методы:
1. Сбор документов в формате .pdf (уже хешированных) в папки согласно структуре (решение Коллегии ЕЭК №79) на 5 модулей и сохранение в формате .zip

### Класс XMLDoc
(если удастся реализовать хеширование и присвоение DocId, либо если это возможно в стороннем ПО автоматически после подгрузки)
###### Атрибуты: 
1. схема XML (Решение Коллегии ЕЭК №79)
###### Методы:
1. сбор XML по кодам из объектов других классов (структура прописана): на вход дается папка (.zip) с хешированными объектами (.pdf) по модулям, на выходе получаем .xml файл.
2. сохранение проекта в формате .zip (расположение модулей в папках, структура прописана в XML, помещенном в корневую папку).

## Внешние методы:
### Программа управления / пользовательский интерфейс:
- Запрашивает данные в формате ввода команд 
- Формирует словарь для замены текста внутри файлов (запрашивает ключ-значение последовательно попарно, для добавления еще одной пары команда вводится повторно)
- Формирует словарь для замены текста в названиях (аналогично)
- Запрашивает директории - исходную и целевую (по умолчанию есть папки в корне проекта)
- Команда для сбора XML


#### Дополнительная информация
- Есть список документов, редактируемых вручную (по кодам) для классов doc и docx, если в названии документа есть такой код, к названию прибавляется "_____"


#### Issues:
1. Проблема с реализацией функции пересохранения doc-docx на windows 8.1 (Word 2013).
При запуске кода вылезает окошко сохранения документа "Сохранить как" (word), вне зависимости от выбранного варианта падает с ошибкой.
На windows 10 все работает. 
Скорее всего, проблема в настройках винды или ворда, но каких? 
Варианты, которые не сработали:
- AsposeWords - платная библиотека, оставляет водяной знак, добавляет копирайт и сокращает документы.
- Сохранение через SaveAs2, а не SaveAs (см. докум. к win32com).
- Открывать как wc.gencache.EnsureDispatch('Word.Application'), использовать doc.Activate().
- Менять настройки сохранения в ворде (не все варианты пробовала).
Можно попробовать: 
- Установить LibreOffice и переписать через supbrocess.calls (гуглится).
- Выкинуть комп или переустановить винду/офис, либо установить linux и переписать под него с другой библиотекой.
Куча неработающего кода лежит в файле sc.dnw.py

2. Разобраться со схемой XML и возможностью автоматической подгрузки по кодам.
Решение Коллегии ЕЭК №79 - подробно о структуре документа. 
Формат актуальный сейчас - XML in ZIP, схема 1.0.0. (в РФ доступна подача в 1.1.0, 1.0.0. пока также принимается).